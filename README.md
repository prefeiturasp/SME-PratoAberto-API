# Estratégia de Transformação Digital e Governo Aberto na SME   
   
Como um governo pode atuar para garantir o bem comum de todos? Na SME, acreditamos que um dos meios para isso seja garantir transparência e prestação de contas e constante relação entre governo e sociedade para o desenvolvimento e implementação de políticas públicas.   
   
A Portaria SME nº 8.008, de 12 de novembro de 2018 oficializou a estratégia da Secretaria Municipal de Educação de SP para que nossas ações sejam pautadas nos princípios de Governo Aberto e para usarmos os valores e benefícios do mundo digital para melhorarmos nossos processos e serviços para os cidadãos. Com isso, pretendemos:   
   
- aumentar os níveis de transparência ativa e de abertura de dados, garantindo a proteção de dados pessoais;   
- instituir metodologias ágeis e colaborativas como parte do processo de desenvolvimento e de evolução de sistemas administrativos e de serviços digitais;   
- fortalecer o controle das políticas educacionais e da aplicação de recursos por parte da gestão e da sociedade;   
- promover espaços e metodologias de colaboração entre governo, Academia, sociedade civil e setor privado.   
   
O Ateliê do Software ([http://forum.govit.prefeitura.sp.gov.br/uploads/default/original/1X/c88a4715eb3f9fc3ceb882c1f6afe9e308805a17.pdf](http://forum.govit.prefeitura.sp.gov.br/uploads/default/original/1X/c88a4715eb3f9fc3ceb882c1f6afe9e308805a17.pdf "http://forum.govit.prefeitura.sp.gov.br/uploads/default/original/1x/c88a4715eb3f9fc3ceb882c1f6afe9e308805a17.pdf")) é uma das ferramentas para operacionalização. Baseado em um modelo de contratação inspirado pelos movimentos ágil e de Software Craftsmanship, trabalhamos com equipes multidisciplinares para o desenvolvimento de produtos que beneficiam toda a comunidade escolar (técnicos da SME e DREs, gestores, professores, alunos e famílias) e concretizam os objetivos da Estratégia de Transformação Digital e Governo Aberto “Pátio Digital”. 

# Conteúdo
  
1. [Sobre o Produto](#Sobre-o-Produto)  
2. [Sobre o Time] (#sobre-o-time)
3. [Como surgiu](#Como-surgiu)   
4. [Links Úteis](#Links-Úteis)   
5. [Comunicação](#Comunicação)   
6. [Como contribuir](#como-contribuir)   
7. [Repositórios](#Repositórios)   
8. [Instalação e Configuração](#Instalação-e-Configuração) 
  
# Sobre o produto

## Visão de futuro

Para a **comunidade escolar e unidades da rede municipal de educação da cidade de São Paulo**  

Que **precisam ter fácil acesso aos cardápios das escolas**  

O **Prato Aberto**  

É uma **plataforma web**  

Que **faz a divulgação de todos os cardápios da rede**  

Diferentemente **da antiga forma de divulgar tal informação, via Diário Oficial do Município de SP, que era pouco eficiente** 

O nosso produto **garante transparência e confiabilidade de forma simples e inovadora.** 
  
## Objetivos de Negócio 
  
O Prato Aberto tem como objetivo de forma transparente, comunicar famílias e comunidade sobre o cardápio fornecido nas escolas da rede municipal de educação de São Paulo. A ferramenta permite a consulta dos cardápios por dia e por escola, com visualização no mapa. Também é possível realizar a avaliação da qualidade das refeições e prevê interação com usuários via Facebook e Telegram, por meio de um assistente virtual, o Robô Edu. 
  
## Personas 

**Direção escolar:** responsável por consultar, validar e dar visibilidade ao cardápio de sua unidade escolar  
  
**Analista de Saúde - Nutricionista do Núcleo de Planejamento de Cardápio:** responsável pela inclusão dos cardápios de todos os tipos de unidades e gestões escolares.   
  
**Estudantes, Familiares e Comunidade Escolar:** acompanhar e avaliar o cardápio diário das alimentações fornecidas 
   
## Funcionalidades 

**Portal**
- Consulta cardápio por escola 
- Para localização da escola, buscar por nome, código EOL ou pelo mapa 
- Visualização dos cardápios por faixa etária e refeição 
- Exporta para PDF e imprimir 
 - Redirecionamento para a ferramenta RoboEdu para avaliar os cardápios 
   
**Robô Edu**

- Consultar e configurar um alerta para receber informações do cardápio publicado
- No caso do Prato Aberto, o Robô Edu faz perguntas já estruturadas para o usuário que levam a uma busca no banco de dados, automatização de envio de informações e perguntas de avaliação do serviço 
  
**Gestão de Cardápios (editor)**

- Upload de arquivo XML extraído do sistema PAPA para cardápios da gestão direta, mista e parceira 
- Criar e editar cardápios por tipo de unidades, refeição e gestão escolar  
- Inclusão e edição do cadastro das escolas  
- Publicar os cardápios no site  
- Download dos cardápios por status (pendente, publicado), por tipo de unidade, por período  
- Mapa de pendencias
  
# Sobre o Time
  
| Papel | Titular | Suplente   
|--|--|--|   
| Product Owner | Jessica Giarletta | Heloisa Teves Scattini |   
| Agente de Governança | Vítor Ferragini |  |   
| Gerente de Projeto | Aline Freitas ||   

# Como surgiu 
  
A plataforma foi desenvolvida por meio de um [desafio aberto para equipes de todo o país](http://patiodigital.prefeitura.sp.gov.br/2017/12/18/aplicativo-prato-aberto-da-transparencia-a-merenda-das-escolas-municipais-de-sao-paulo/) . Foram nove finalistas da 1ª Seleção de Inovação Tecnológica do Pátio Digital, que tinha como desafio melhorar a disponibilização de informações sobre o cardápio escolar por meio da criação de um aplicativo. O grupo vencedor, formado por Guilherme Cordeiro, Maurício Longato, Vitor Makiyama e Lucas Santos, passou os últimos quatro meses desenvolvendo o aplicativo Prato Aberto. 
  
# Links Úteis
  
**Homologação:** 
  
[http://hom-pratoaberto.sme.prefeitura.sp.gov.br/](http://hom-pratoaberto.sme.prefeitura.sp.gov.br/) 
  
**Produção:** 
  
[https://pratoaberto.sme.prefeitura.sp.gov.br/](https://pratoaberto.sme.prefeitura.sp.gov.br/) 
 
# Comunicação:

| Canal de comunicação | Objetivos |
|----------------------|-----------|
| [Issues do Github](https://github.com/prefeiturasp/SME-PratoAberto-API/issues) | - Sugestão de novas funcionalidades<br> - Reportar bugs<br> - Discussões técnicas |

# Como contribuir

Contribuições são **super bem vindas**! Se você tem vontade de construir o Prato Aberto conosco, veja o nosso [guia de contribuição](./CONTRIBUTING.md) onde explicamos detalhadamente como trabalhamos e de que formas você pode nos ajudar a alcançar nossos objetivos. Lembrando que todos devem seguir  nosso [código de conduta](./CODEOFCONDUCT.md). 
  
# Repositórios
  
Informar os repositórios de código que envolvem a solução: 
  
[SME-PratoAberto-API] ([https://github.com/prefeiturasp/SME-PratoAberto-API](https://github.com/prefeiturasp/SME-PratoAberto-API) 
  
[SME-PratoAberto-Frontend] 
[[https://github.com/prefeiturasp/SME-PratoAberto-Frontend](https://github.com/prefeiturasp/SME-PratoAberto-Frontend) 
  
[SME-PratoAberto-Editor] 
[https://github.com/prefeiturasp/SME-PratoAberto-Editor](https://github.com/prefeiturasp/SME-PratoAberto-Editor) 
  
[SME-PratoAberto-Edu] 
[https://github.com/prefeiturasp/SME-PratoAberto-Edu](https://github.com/prefeiturasp/SME-PratoAberto-Edu) 
  

# Instalação e Configuração

Instale os requisitos através do `requirements.txt` e configure uma variável de ambiente chamada API_MONGO_URI com o apontamento para a base.

```
pip install -r requirements.txt
export API_MONGO_URI=localhost:27017
FLASK_APP=api.py flask run
```

## Instalação usando Docker

Dentro do diretório do projeto, inicie a aplicação usando `docker-compose`.

`docker-compose up -D --build`


Instale MongoDB versão mínima 3.6:

[Windows](http://treehouse.github.io/installation-guides/windows/mongo-windows.html)
[Mac](http://treehouse.github.io/installation-guides/mac/mongo-mac.html)

```
mongod --fork --logpath <arquivo_para_logs (exemplo:/var/log/mongod.log)>
mongorestore -d pratoaberto -c cardapios ./cardapios.bson 
mongorestore -d pratoaberto -c escolas ./escolas.bson 
```

# Endpoints

## /escolas

Lista escolas da rede publica.

Argumentos de query string:

```
nome:   string - opcional
        Permite a filtragem da lista de escolas pelo nome
```



Retorno:

```
[
    {
        "_id": 91065,
        "nome": "EMEI ELIS REGINA - (TERCEI.)",
        "endereco": "R. ERNESTO MANOGRASSO, 340",
        "bairro": "CID. SÃO MATEUS",
        "lat": -23.611117,
        "lon": -46.479426
    },
    ...
]
```

## /escola/<int:id_escola>

Lista detalhes de uma determina escola pelo seu identificador (código Escola Online - EOL)

Parametros:

```
id_escola:    int
```


Retorno:

```
{
    "nome": "EMEI ELIS REGINA - (TERCEI.)",
    "tipo_unidade": "EMEI",
    "tipo_atendimento": "TERCEIRIZADA",
    "agrupamento": 4,
    "endereco": "R. ERNESTO MANOGRASSO, 340",
    "bairro": "CID. SÃO MATEUS",
    "telefone": "(11)29199960",
    "lat": -23.611117,
    "lon": -46.479426,
    "idades": [
        "Z - UNIDADES SEM FAIXA"
    ]
}
```

## /cardapios ou /cardapios/<data>

Lista os cardapios disponíveis

Parametros:

```
data:   string - opcional
        Formato: YYYYMMDD
```

Argumentos de query string:

```
agrupamento:        string - opcional
tipo_atendimento:   string - opcional
tipo_unidade:       string - opcional
idade:              string - opcional
data_inicial:       string - opcional
data_final:         string - opcional
```


Retorno:

```
[
    {
        "data": "20170922",
        "idade": "1 A 3 MESES",
        "tipo_atendimento": "DIRETA",
        "tipo_unidade": "CEI_CONVENIADO",
        "agrupamento": "4",
        "cardapio": {
            "Jantar": [
                "FORMULA LÁCTEA"
            ],
            "Desjejum": [
                "FORMULA LACTEA"
            ],
            "Almoco": [
                "FORMULA LACTEA"
            ],
            "Lanche": [
                "FORMULA LÁCTEA"
            ]
        },
    },
    ...
]
```


## /editor/cardapios

Permite a listagem e a alteração dos dados de cardápio.

Para acesso, é necessário enviar uma chave através do cabeçalho HTTP `key`. A chave deve ser a mesma que a variável de ambiente `API_KEY`

Argumentos de query string:

```
status:             string - opcional
agrupamento:        string - opcional
tipo_atendimento:   string - opcional
tipo_unidade:       string - opcional
idade:              string - opcional
data_inicial:       string - opcional
data_final:         string - opcional
```


Retorno:

```
[
    {
        "data": "20170922",
        "idade": "1 A 3 MESES",
        "tipo_atendimento": "DIRETA",
        "tipo_unidade": "CEI_CONVENIADO",
        "agrupamento": "4",
        "cardapio": {
            "Jantar": [
                "FORMULA LÁCTEA"
            ],
            "Desjejum": [
                "FORMULA LACTEA"
            ],
            "Almoco": [
                "FORMULA LACTEA"
            ],
            "Lanche": [
                "FORMULA LÁCTEA"
            ]
        },
    },
    ...
]
```

## /status

Verifica se a API está online.


Retorno:

```
{
    "status": "ativo"
}
```

Baseado no Readme do [i-educar](https://github.com/portabilis/i-educar)
